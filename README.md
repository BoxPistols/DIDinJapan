# Japan Overlay Map

日本の各種地理データをオーバーレイ表示できる汎用地図ライブラリです。

## 機能

- 全47都道府県の人口集中地区（DID）データを表示
- 地域別グループ化されたレイヤー管理
- 透明度調整スライダー
- ホバー時のポップアップ情報（人口、面積、人口密度）
- 一括表示/非表示切り替え

## セットアップ

```bash
npm install
npm run dev
```

ブラウザで http://localhost:5173 を開きます。

## 技術スタック

- React 18
- TypeScript
- MapLibre GL JS
- Vite
- Storybook 8

## 気象情報とオーバーレイ

本アプリケーションは複数の気象・地理データソースを統合しています。

### 実装済みのAPI

| レイヤー | データソース | APIキー | 状態 |
|---------|-----------|--------|------|
| **雨雲レーダー** | [RainViewer API](https://www.rainviewer.com/api.html) | 不要 | ✅ 本番運用可能 |
| 気象情報（風・気圧等） | [OpenWeatherMap](https://openweathermap.org/api) | 必須 | ⚠️ 構造実装済み |

#### 雨雲レーダー (RainViewer API)
- **エンドポイント**: `https://api.rainviewer.com/public/weather-maps.json`
- **更新頻度**: 5分ごと自動更新
- **データ**: 過去のレーダーデータと降水予報（nowcast）
- **APIキー**: 不要（無料サービス）
- **フォールバック**: API失敗時は `(見本)` マーク付きモックを表示
- **実装**: `src/lib/services/rainViewer.ts`

#### OpenWeatherMap API
- **機能**: 風向・風速、気圧、降水量、視界情報
- **APIキー**: 必須（別途取得が必要）
- **実装**: `src/lib/services/openWeather.ts`

### モック表示機能

デモンストレーション用のモックデータを使用:
- **建物（地物）**: `util/geo.ts`で生成
- **LTEカバレッジ**: ローカルモック
- **風向・風速**: APIキー未設定時にモック表示

詳細は [NEXT_ACTION.md](./docs/NEXT_ACTION.md) のAPI仕様セクションを参照。

## データについて

本データは、政府統計の総合窓口（e-Stat）で公開されている「人口集中地区」データを、GeoJSON形式に変換したものです。

- **座標系**: EPSG:4326（緯度経度座標系/WGS84）
- **データ年次**: 平成22年（2010年）国勢調査

## 参考リンク

- [国土地理院 地理院地図](https://maps.gsi.go.jp/)
- [政府統計の総合窓口（e-Stat）](https://www.e-stat.go.jp/)

## ライセンス・利用規約

本データは[政府統計の総合窓口（e-Stat）利用規約](https://www.e-stat.go.jp/terms-of-use)に基づき利用可能です。

### 利用条件

- **自由利用可能**: 複製、公衆送信、翻訳・変形等が可能
- **商用利用可能**

### 出典の記載

利用する際は出典を記載してください：

```
出典：政府統計の総合窓口(e-Stat)（https://www.e-stat.go.jp/）
「人口集中地区」データを加工して作成
```

### 禁止事項

- 国が作成したかのように見せかけること
- 法令、条例または公序良俗に反する利用

### 免責事項

本データの利用によって生じた損害について、一切の責任を負いません。
